<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="JESUS Bingo" />
  <meta name="theme-color" content="#2a1a08" />
  <title>JESUS Bingo</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&family=IM+Fell+English:ital@0;1&family=Cinzel:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --vellum: #f2e8c8;
      --ink: #1a1208;
      --ink-brown: #3d2b0e;
      --ink-faded: #6b5230;
      --gold-leaf: #c8960c;
      --gold-bright: #e8b820;
      --gold-dark: #8a6408;
      --crimson: #8b1a1a;
      --crimson-dark: #5a0e0e;
      --cobalt: #1a3a7a;
      --verdigris: #2a6a4a;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    html, body { height: 100%; overflow: hidden; font-family: 'IM Fell English', serif; color: var(--ink); }
    body { background-color: #1a0e04; }
    body::before {
      content: '';
      position: fixed; inset: 0;
      background:
        radial-gradient(ellipse 70% 50% at 15% 20%, rgba(180,140,60,0.18) 0%, transparent 60%),
        radial-gradient(ellipse 50% 60% at 85% 75%, rgba(160,120,40,0.14) 0%, transparent 55%),
        radial-gradient(ellipse 80% 80% at 50% 50%, #f5ead0 0%, #e8d8a8 40%, #d4c080 100%);
      pointer-events: none; z-index: 0;
    }
    body::after {
      content: '';
      position: fixed; inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='p'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23p)' opacity='0.07'/%3E%3C/svg%3E");
      pointer-events: none; z-index: 0; opacity: 0.5;
    }

    /* === LANDSCAPE LAYOUT === */
    .app {
      position: relative; z-index: 1;
      height: 100dvh;
      display: flex;
      align-items: stretch;
      padding: env(safe-area-inset-top,0px) env(safe-area-inset-right,0px) env(safe-area-inset-bottom,0px) env(safe-area-inset-left,0px);
      overflow: hidden;
    }
    .page-frame {
      flex: 1;
      display: flex;
      flex-direction: row;
      position: relative;
      margin: 10px;
    }
    .page-frame::before {
      content: ''; position: absolute; inset: 4px;
      border: 2px solid var(--gold-dark); pointer-events: none; z-index: 10;
    }
    .page-frame::after {
      content: ''; position: absolute; inset: 9px;
      border: 1px solid rgba(138,100,8,0.35); pointer-events: none; z-index: 10;
    }

    /* Corner ornaments */
    .corner { position: absolute; width: 72px; height: 72px; z-index: 20; pointer-events: none; }
    .corner.tl { top: 0; left: 0; }
    .corner.tr { top: 0; right: 0; transform: scaleX(-1); }
    .corner.bl { bottom: 0; left: 0; transform: scaleY(-1); }
    .corner.br { bottom: 0; right: 0; transform: scale(-1,-1); }

    /* === LEFT PANEL === */
    .left-panel {
      width: 360px;
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      padding: 20px 20px 20px 28px;
      border-right: 1px solid rgba(138,100,8,0.4);
    }

    /* === RIGHT PANEL === */
    .right-panel {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 20px 28px 20px 20px;
      min-width: 0;
    }

    /* Header */
    .header { text-align: center; padding: 4px 16px 4px; }
    .rubric-line {
      font-family: 'IM Fell English', serif; font-style: italic;
      font-size: 10px; letter-spacing: 0.22em; color: var(--crimson);
      text-transform: uppercase; margin-bottom: 3px;
    }
    .title-row {
      display: flex; justify-content: center; align-items: flex-end;
      gap: 0; line-height: 1; margin: 0 0 3px;
    }
    .title-drop {
      font-family: 'UnifrakturMaguntia', cursive;
      font-size: 70px;
      color: var(--crimson);
      text-shadow: 1px 1px 0 var(--crimson-dark), 2px 2px 3px rgba(0,0,0,0.25);
      line-height: 1;
      -webkit-text-stroke: 0.5px var(--gold-dark);
    }
    .title-rest {
      font-family: 'UnifrakturMaguntia', cursive;
      font-size: 44px;
      color: var(--ink-brown); line-height: 1.2;
      -webkit-text-stroke: 0.3px var(--gold-dark);
    }
    .subtitle {
      font-family: 'Cinzel', serif;
      font-size: 10px;
      letter-spacing: 0.38em; color: var(--ink-faded);
      text-transform: uppercase; margin-top: 2px;
    }
    .ruled-line {
      display: flex; align-items: center; gap: 8px;
      margin: 5px 8px 0;
    }
    .ruled-line::before, .ruled-line::after {
      content: ''; flex: 1; height: 1px;
      background: linear-gradient(90deg, transparent, var(--gold-dark), transparent);
    }
    .ruled-line span { font-size: 13px; color: var(--gold-dark); opacity: 0.8; }

    /* Column headers */
    .column-headers {
      display: flex; justify-content: center; gap: 6px;
      margin: 10px 0 8px;
    }
    .col-header {
      flex: 1;
      height: 84px;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      font-family: 'UnifrakturMaguntia', cursive; font-size: 64px;
      background: rgba(200,150,12,0.07);
      border: 1px solid rgba(138,100,8,0.3);
      border-bottom: 2px solid var(--gold-dark);
      transition: all 0.3s ease; position: relative;
    }
    .col-header .range {
      font-family: 'IM Fell English', serif; font-style: italic;
      font-size: 8px; color: var(--ink-faded); line-height: 1; margin-top: 1px;
    }
    .col-header.J  { color: var(--crimson); }
    .col-header.E  { color: var(--cobalt); }
    .col-header.S  { color: var(--verdigris); }
    .col-header.U  { color: var(--gold-dark); }
    .col-header.S2 { color: var(--crimson-dark); }
    .col-header.active {
      transform: scale(1.1);
      background: rgba(200,150,12,0.18);
      border-color: var(--gold-leaf);
      box-shadow: 0 2px 10px rgba(200,150,12,0.25);
    }

    /* Call display */
    .call-container { margin: 4px 0 8px; position: relative; }
    .call-display {
      background: rgba(250,240,210,0.65);
      border: 1px solid var(--gold-dark);
      padding: 18px 12px 14px;
      text-align: center; position: relative;
    }
    .call-display::before {
      content: ''; position: absolute; inset: 3px;
      border: 1px solid rgba(138,100,8,0.2); pointer-events: none;
    }
    .call-display::after {
      content: 'Numerus Electus';
      position: absolute; top: -10px; left: 50%; transform: translateX(-50%);
      background: #ede2bc; padding: 0 8px;
      font-family: 'UnifrakturMaguntia', cursive;
      font-size: 14px; color: var(--crimson); letter-spacing: 0.1em; white-space: nowrap;
    }
    .call-value {
      display: flex; align-items: center; justify-content: center;
      gap: 6px; min-height: 96px;
    }
    .call-letter {
      font-family: 'UnifrakturMaguntia', cursive;
      font-size: 90px;
      line-height: 1; transition: color 0.3s ease;
    }
    .call-number {
      font-family: 'IM Fell English', serif;
      font-size: 82px;
      line-height: 1; color: var(--ink); transition: color 0.3s ease;
    }
    .call-letter.idle { color: rgba(60,43,14,0.18); }
    .call-number.idle { color: rgba(26,18,8,0.18); }
    .call-letter.J  { color: var(--crimson); }
    .call-letter.E  { color: var(--cobalt); }
    .call-letter.S  { color: var(--verdigris); }
    .call-letter.U  { color: var(--gold-dark); }
    .call-letter.S2 { color: var(--crimson-dark); }
    @keyframes illuminateIn {
      0%   { transform: scale(0.55) rotate(-4deg); opacity: 0; }
      55%  { transform: scale(1.12) rotate(1deg); opacity: 1; }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }
    .popin { animation: illuminateIn 0.45s cubic-bezier(0.34,1.56,0.64,1) both; }
    .call-count {
      margin-top: 8px; font-family: 'IM Fell English', serif;
      font-style: italic; font-size: 13px; color: var(--ink-faded);
    }

    /* Draw button */
    .draw-btn {
      width: 100%; margin: 10px 0 0;
      padding: 14px 10px;
      background: linear-gradient(180deg, #a02020 0%, var(--crimson-dark) 100%);
      border: 1px solid #6a1010; border-bottom: 3px solid #3a0808;
      color: #f5e8c8;
      font-family: 'UnifrakturMaguntia', cursive;
      font-size: 26px;
      cursor: pointer; position: relative;
      box-shadow: inset 0 1px 0 rgba(255,200,160,0.15), 0 3px 8px rgba(60,0,0,0.3);
      transition: transform 0.1s, box-shadow 0.1s;
      -webkit-appearance: none;
      text-shadow: 0 1px 2px rgba(0,0,0,0.4);
    }
    .draw-btn::before {
      content: ''; position: absolute; inset: 3px 4px;
      border: 1px solid rgba(255,180,140,0.1); pointer-events: none;
    }
    .draw-btn:active { transform: translateY(1px); box-shadow: 0 1px 4px rgba(60,0,0,0.3); }
    .draw-btn:disabled { background: #a09268; border-color: #706040; box-shadow: none; opacity: 0.5; cursor: not-allowed; }

    /* Right panel title */
    .right-panel-title {
      text-align: center;
      margin-bottom: 10px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--gold-dark);
    }
    .right-panel-title .rubric-line { margin-bottom: 0; font-size: 11px; }

    /* History */
    .history-section { flex: 1; min-height: 0; display: flex; flex-direction: column; }
    .history-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 8px;
    }
    .history-title { font-family: 'IM Fell English', serif; font-style: italic; font-size: 13px; color: var(--crimson); letter-spacing: 0.08em; }
    .reset-btn {
      background: none; border: 1px solid var(--gold-dark);
      color: var(--ink-faded); font-family: 'Cinzel', serif;
      font-size: 9px; letter-spacing: 0.2em;
      padding: 4px 10px; cursor: pointer; text-transform: uppercase;
      -webkit-appearance: none; transition: all 0.2s;
    }
    .reset-btn:active { background: rgba(138,100,8,0.1); color: var(--ink); }
    .history-grid {
      display: flex; flex-wrap: wrap; gap: 5px;
      padding: 10px;
      background: rgba(240,228,195,0.45);
      border: 1px solid rgba(138,100,8,0.25);
      overflow-y: auto; flex: 1;
      align-content: flex-start;
    }
    .history-chip {
      padding: 5px 14px; font-family: 'IM Fell English', serif;
      font-size: 28px; opacity: 0; border: 1px solid;
      animation: chipAppear 0.3s ease forwards;
    }
    @keyframes chipAppear { from { opacity:0; transform:scale(0.7); } to { opacity:1; transform:scale(1); } }
    .chip-J  { color: var(--crimson);      border-color: rgba(139,26,26,0.35);  background: rgba(139,26,26,0.07); }
    .chip-E  { color: var(--cobalt);       border-color: rgba(26,58,122,0.35);  background: rgba(26,58,122,0.07); }
    .chip-S  { color: var(--verdigris);    border-color: rgba(42,106,74,0.35);  background: rgba(42,106,74,0.07); }
    .chip-U  { color: var(--gold-dark);    border-color: rgba(138,100,8,0.35);  background: rgba(138,100,8,0.07); }
    .chip-S2 { color: var(--crimson-dark); border-color: rgba(90,14,14,0.35);   background: rgba(90,14,14,0.07); }

    /* All called banner */
    .all-called { display:none; text-align:center; padding:8px 12px; background:rgba(200,150,12,0.1); border:1px solid var(--gold-dark); margin-top: 8px; }
    .all-called.show { display:block; }
    .all-called p { font-family:'IM Fell English',serif; font-style:italic; font-size:12px; color:var(--crimson); }

    /* Modal */
    .modal-overlay { position:fixed; inset:0; background:rgba(20,12,4,0.72); display:flex; align-items:center; justify-content:center; z-index:100; opacity:0; pointer-events:none; transition:opacity 0.3s; }
    .modal-overlay.show { opacity:1; pointer-events:all; }
    .modal { background:var(--vellum); border:2px solid var(--gold-dark); padding:28px 24px; text-align:center; max-width:300px; width:90%; position:relative; box-shadow:0 20px 60px rgba(0,0,0,0.5); }
    .modal::before { content:''; position:absolute; inset:5px; border:1px solid rgba(138,100,8,0.22); pointer-events:none; }
    .modal h2 { font-family:'UnifrakturMaguntia',cursive; font-size:24px; color:var(--crimson); margin-bottom:12px; }
    .modal p { font-family:'IM Fell English',serif; font-style:italic; font-size:14px; color:var(--ink-faded); margin-bottom:20px; line-height:1.6; }
    .modal-btns { display:flex; gap:10px; justify-content:center; }
    .modal-btn { padding:9px 20px; font-family:'Cinzel',serif; font-size:10px; letter-spacing:0.15em; cursor:pointer; border:1px solid; text-transform:uppercase; -webkit-appearance:none; transition:all 0.15s; }
    .modal-btn.confirm { background:var(--crimson); border-color:var(--crimson-dark); color:#f5e8c8; }
    .modal-btn.cancel  { background:transparent; border-color:var(--gold-dark); color:var(--ink-faded); }
    .modal-btn:active  { transform:scale(0.96); }
    .version-mark {
      position: fixed; bottom: 14px; right: 18px; z-index: 200;
      font-family: 'IM Fell English', serif; font-style: italic;
      font-size: 22px; color: rgba(107,82,48,0.75);
      letter-spacing: 0.1em; pointer-events: none;
    }

    /* Timer */
    .timer-section {
      margin: 12px 0 0;
      display: flex; flex-direction: column; align-items: center; gap: 8px;
    }
    .timer-label {
      font-family: 'IM Fell English', serif; font-style: italic;
      font-size: 10px; letter-spacing: 0.18em; color: var(--crimson);
      text-transform: uppercase;
    }
    .timer-ring-wrap {
      position: relative; width: 110px; height: 110px;
      display: flex; align-items: center; justify-content: center;
    }
    .timer-ring {
      position: absolute; inset: 0; width: 100%; height: 100%;
      transform: rotate(-90deg);
    }
    .timer-ring-bg {
      fill: none; stroke: rgba(138,100,8,0.15); stroke-width: 6;
    }
    .timer-ring-fill {
      fill: none; stroke: var(--crimson); stroke-width: 6;
      stroke-linecap: round;
      stroke-dasharray: 326.7;
      stroke-dashoffset: 0;
      transition: stroke-dashoffset 1s linear, stroke 0.4s;
    }
    .timer-ring-fill.warning { stroke: var(--gold-dark); }
    .timer-ring-fill.urgent  { stroke: #c0392b; }
    .timer-face {
      position: relative; z-index: 1;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      width: 86px; height: 86px;
      background: rgba(250,240,210,0.6);
      border: 1px solid rgba(138,100,8,0.3);
      border-radius: 50%;
    }
    .timer-digits {
      font-family: 'IM Fell English', serif;
      font-size: 42px; line-height: 1;
      color: var(--ink);
      transition: color 0.3s;
    }
    .timer-digits.warning { color: var(--gold-dark); }
    .timer-digits.urgent  { color: var(--crimson); }
    @keyframes timerPulse {
      0%, 100% { transform: scale(1); }
      50%       { transform: scale(1.12); }
    }
    .timer-digits.pulse { animation: timerPulse 0.5s ease; }
    .timer-btns { display: flex; gap: 10px; width: 100%; }
    .timer-btn {
      flex: 1;
      padding: 11px 10px;
      font-family: 'UnifrakturMaguntia', cursive; font-size: 18px;
      cursor: pointer;
      border: 1px solid var(--gold-dark); -webkit-appearance: none;
      transition: all 0.15s;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }
    .timer-btn.start  { background: linear-gradient(180deg,#a02020,var(--crimson-dark)); border-color:#6a1010; border-bottom: 3px solid #3a0808; color:#f5e8c8; box-shadow: inset 0 1px 0 rgba(255,200,160,0.15), 0 3px 8px rgba(60,0,0,0.3); }
    .timer-btn.reset  { background: linear-gradient(180deg, #7a6830, #5a4a18); border-color: var(--gold-dark); border-bottom: 3px solid var(--gold-dark); color: #f5e8c8; box-shadow: inset 0 1px 0 rgba(255,220,160,0.1), 0 3px 8px rgba(40,30,0,0.3); }
    .timer-btn:active { transform: translateY(1px); box-shadow: 0 1px 4px rgba(60,0,0,0.3); }
    .timer-btn:disabled { opacity: 0.4; cursor: not-allowed; }
  </style>
</head>
<body>
<div class="app">
<div class="page-frame">

  <!-- Corner illuminations -->
  <svg class="corner tl" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 62 L2 2 L62 2" stroke="#8a6408" stroke-width="2.5" fill="none"/>
    <path d="M8 56 L8 8 L56 8" stroke="rgba(138,100,8,0.3)" stroke-width="1" fill="none"/>
    <path d="M8 38 Q12 26 18 22 Q24 18 26 26 Q28 34 22 38 Q16 42 20 50 Q24 54 32 52" stroke="#2a6a4a" stroke-width="1.8" fill="none" stroke-linecap="round"/>
    <ellipse cx="18" cy="22" rx="5" ry="3" fill="#2a6a4a" transform="rotate(-35 18 22)" opacity="0.75"/>
    <ellipse cx="22" cy="36" rx="4.5" ry="2.5" fill="#2a6a4a" transform="rotate(25 22 36)" opacity="0.7"/>
    <ellipse cx="30" cy="50" rx="4" ry="2.2" fill="#2a6a4a" transform="rotate(-20 30 50)" opacity="0.75"/>
    <circle cx="26" cy="26" r="3.5" fill="#8b1a1a" opacity="0.85"/>
    <circle cx="14" cy="32" r="2.5" fill="#8b1a1a" opacity="0.7"/>
    <circle cx="32" cy="52" r="2.5" fill="#c8960c"/>
    <polygon points="2,2 10,2 2,10" fill="#c8960c" opacity="0.9"/>
    <line x1="5" y1="2" x2="5" y2="10" stroke="#8a6408" stroke-width="0.8"/>
    <line x1="2" y1="5" x2="10" y2="5" stroke="#8a6408" stroke-width="0.8"/>
  </svg>
  <svg class="corner tr" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 62 L2 2 L62 2" stroke="#8a6408" stroke-width="2.5" fill="none"/>
    <path d="M8 56 L8 8 L56 8" stroke="rgba(138,100,8,0.3)" stroke-width="1" fill="none"/>
    <path d="M8 38 Q12 26 18 22 Q24 18 26 26 Q28 34 22 38 Q16 42 20 50 Q24 54 32 52" stroke="#1a3a7a" stroke-width="1.8" fill="none" stroke-linecap="round"/>
    <ellipse cx="18" cy="22" rx="5" ry="3" fill="#1a3a7a" transform="rotate(-35 18 22)" opacity="0.7"/>
    <ellipse cx="22" cy="36" rx="4.5" ry="2.5" fill="#1a3a7a" transform="rotate(25 22 36)" opacity="0.65"/>
    <ellipse cx="30" cy="50" rx="4" ry="2.2" fill="#1a3a7a" transform="rotate(-20 30 50)" opacity="0.7"/>
    <circle cx="26" cy="26" r="3.5" fill="#c8960c" opacity="0.85"/>
    <circle cx="14" cy="32" r="2.5" fill="#c8960c" opacity="0.7"/>
    <circle cx="32" cy="52" r="2.5" fill="#8b1a1a"/>
    <polygon points="2,2 10,2 2,10" fill="#c8960c" opacity="0.9"/>
    <line x1="5" y1="2" x2="5" y2="10" stroke="#8a6408" stroke-width="0.8"/>
    <line x1="2" y1="5" x2="10" y2="5" stroke="#8a6408" stroke-width="0.8"/>
  </svg>
  <svg class="corner bl" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 62 L2 2 L62 2" stroke="#8a6408" stroke-width="2.5" fill="none"/>
    <path d="M8 56 L8 8 L56 8" stroke="rgba(138,100,8,0.3)" stroke-width="1" fill="none"/>
    <path d="M8 38 Q12 26 18 22 Q24 18 26 26 Q28 34 22 38 Q16 42 20 50 Q24 54 32 52" stroke="#2a6a4a" stroke-width="1.8" fill="none" stroke-linecap="round"/>
    <ellipse cx="18" cy="22" rx="5" ry="3" fill="#2a6a4a" transform="rotate(-35 18 22)" opacity="0.75"/>
    <ellipse cx="22" cy="36" rx="4.5" ry="2.5" fill="#c8960c" transform="rotate(25 22 36)" opacity="0.75"/>
    <circle cx="26" cy="26" r="3.5" fill="#8b1a1a" opacity="0.8"/>
    <circle cx="32" cy="52" r="2.5" fill="#c8960c"/>
    <polygon points="2,2 10,2 2,10" fill="#c8960c" opacity="0.9"/>
    <line x1="5" y1="2" x2="5" y2="10" stroke="#8a6408" stroke-width="0.8"/>
    <line x1="2" y1="5" x2="10" y2="5" stroke="#8a6408" stroke-width="0.8"/>
  </svg>
  <svg class="corner br" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 62 L2 2 L62 2" stroke="#8a6408" stroke-width="2.5" fill="none"/>
    <path d="M8 56 L8 8 L56 8" stroke="rgba(138,100,8,0.3)" stroke-width="1" fill="none"/>
    <path d="M8 38 Q12 26 18 22 Q24 18 26 26 Q28 34 22 38 Q16 42 20 50 Q24 54 32 52" stroke="#1a3a7a" stroke-width="1.8" fill="none" stroke-linecap="round"/>
    <ellipse cx="18" cy="22" rx="5" ry="3" fill="#1a3a7a" transform="rotate(-35 18 22)" opacity="0.7"/>
    <ellipse cx="22" cy="36" rx="4.5" ry="2.5" fill="#2a6a4a" transform="rotate(25 22 36)" opacity="0.7"/>
    <circle cx="26" cy="26" r="3.5" fill="#c8960c" opacity="0.8"/>
    <circle cx="32" cy="52" r="2.5" fill="#8b1a1a"/>
    <polygon points="2,2 10,2 2,10" fill="#c8960c" opacity="0.9"/>
    <line x1="5" y1="2" x2="5" y2="10" stroke="#8a6408" stroke-width="0.8"/>
    <line x1="2" y1="5" x2="10" y2="5" stroke="#8a6408" stroke-width="0.8"/>
  </svg>

  <!-- LEFT PANEL: Title + Column Headers + Call Display + Draw Button -->
  <div class="left-panel">
    <header class="header">
      <div class="rubric-line">✠ Ludus Numerorum Sacrorum ✠</div>
      <div class="title-row">
        <span class="title-drop">J</span><span class="title-rest">esus</span>
      </div>
      <p class="subtitle">Bingo · Anno Domini MMXXVI</p>
      <div class="ruled-line"><span>✦</span></div>
    </header>

    <div class="column-headers">
      <div class="col-header J" id="hdr-J">J<span class="range">1–15</span></div>
      <div class="col-header E" id="hdr-E">E<span class="range">16–30</span></div>
      <div class="col-header S" id="hdr-S">S<span class="range">31–45</span></div>
      <div class="col-header U" id="hdr-U">U<span class="range">46–60</span></div>
      <div class="col-header S2" id="hdr-S2">S<span class="range">61–75</span></div>
    </div>

    <div class="call-container">
      <div class="call-display">
        <div class="call-value">
          <div class="call-letter idle" id="callLetter">?</div>
          <div class="call-number idle" id="callNumber">–</div>
        </div>
        <div class="call-count" id="callCount">Nullus numerus electus est</div>
      </div>
    </div>

    <button class="draw-btn" id="drawBtn" onclick="drawNumber()">✠ Elige Numerum ✠</button>

    <!-- Countdown Timer -->
    <div class="timer-section">
      <div class="timer-label">✠ Tempus — Lightning Round ✠</div>
      <div class="timer-ring-wrap">
        <svg class="timer-ring" viewBox="0 0 120 120">
          <circle class="timer-ring-bg" cx="60" cy="60" r="52"/>
          <circle class="timer-ring-fill" id="timerArc" cx="60" cy="60" r="52"/>
        </svg>
        <div class="timer-face">
          <div class="timer-digits" id="timerDigits">10</div>
        </div>
      </div>
      <div class="timer-btns">
        <button class="timer-btn start" id="timerStartBtn" onclick="timerStart()">Start</button>
        <button class="timer-btn reset" id="timerResetBtn" onclick="timerReset()">Reset</button>
      </div>
    </div>


    <div class="all-called" id="allCalled">
      <p>✠ Omnes Numeri Electi Sunt · All 75 Called ✠</p>
    </div>
  </div>

  <!-- RIGHT PANEL: History -->
  <div class="right-panel">
    <div class="history-section">
      <div class="history-header">
        <span class="history-title">✠ Numeri Electi — Called Numbers</span>
        <button class="reset-btn" onclick="confirmReset()">Reset</button>
      </div>
      <div class="history-grid" id="historyGrid"></div>
    </div>
  </div>

</div>
</div>

<!-- Reset Modal -->
<div class="modal-overlay" id="resetModal">
  <div class="modal">
    <h2>Nova Tabula?</h2>
    <p>All called numbers will be cleared and a new game shall begin.</p>
    <div class="modal-btns">
      <button class="modal-btn cancel" onclick="closeModal()">Cancel</button>
      <button class="modal-btn confirm" onclick="doReset()">Reset</button>
    </div>
  </div>
</div>

<script>
  const TOTAL = 75;
  let calledNumbers = new Set();
  const letterMap = n => {
    if (n <= 15) return { letter: 'J', cls: 'J' };
    if (n <= 30) return { letter: 'E', cls: 'E' };
    if (n <= 45) return { letter: 'S', cls: 'S' };
    if (n <= 60) return { letter: 'U', cls: 'U' };
    return { letter: 'S', cls: 'S2' };
  };
  function drawNumber() {
    if (calledNumbers.size >= TOTAL) return;
    let num;
    do { num = Math.floor(Math.random() * TOTAL) + 1; } while (calledNumbers.has(num));
    calledNumbers.add(num);
    updateDisplay(num); addChip(num); updateCount();
    if (calledNumbers.size >= TOTAL) {
      document.getElementById('drawBtn').disabled = true;
      document.getElementById('allCalled').classList.add('show');
    }
  }
  function updateDisplay(num) {
    const { letter, cls } = letterMap(num);
    const lEl = document.getElementById('callLetter');
    const nEl = document.getElementById('callNumber');
    lEl.classList.remove('popin','idle','J','E','S','U','S2');
    nEl.classList.remove('popin','idle');
    void lEl.offsetWidth;
    lEl.textContent = letter; nEl.textContent = num;
    lEl.classList.add(cls,'popin'); nEl.classList.add('popin');
    ['J','E','S','U','S2'].forEach(c => document.getElementById('hdr-'+c)?.classList.remove('active'));
    document.getElementById('hdr-'+cls)?.classList.add('active');
  }
  function addChip(num) {
    const { letter, cls } = letterMap(num);
    const chip = document.createElement('div');
    chip.className = `history-chip chip-${cls}`;
    chip.textContent = `${letter}·${num}`;
    const grid = document.getElementById('historyGrid');
    grid.appendChild(chip);
    grid.scrollTop = grid.scrollHeight;
  }
  function updateCount() {
    const n = calledNumbers.size;
    document.getElementById('callCount').textContent = n === 1 ? 'I of LXXV called' : `${n} of LXXV called`;
  }
  function confirmReset() { document.getElementById('resetModal').classList.add('show'); }
  function closeModal()    { document.getElementById('resetModal').classList.remove('show'); }
  function doReset() {
    calledNumbers.clear();
    const lEl = document.getElementById('callLetter');
    const nEl = document.getElementById('callNumber');
    lEl.textContent = '?'; lEl.className = 'call-letter idle';
    nEl.textContent = '–'; nEl.className = 'call-number idle';
    document.getElementById('callCount').textContent = 'Nullus numerus electus est';
    document.getElementById('historyGrid').innerHTML = '';
    document.getElementById('allCalled').classList.remove('show');
    document.getElementById('drawBtn').disabled = false;
    ['J','E','S','U','S2'].forEach(c => document.getElementById('hdr-'+c)?.classList.remove('active'));
    closeModal();
  }
  document.getElementById('resetModal').addEventListener('click', function(e) { if(e.target===this) closeModal(); });
  // ── Countdown Timer ──
  const TIMER_DURATION = 10;
  const CIRCUMFERENCE = 2 * Math.PI * 52; // 326.7
  let timerRemaining = TIMER_DURATION;
  let timerInterval = null;
  let timerRunning = false;

  function timerSetArc(remaining) {
    const frac = remaining / TIMER_DURATION;
    const offset = CIRCUMFERENCE * (1 - frac);
    const arc = document.getElementById('timerArc');
    const digits = document.getElementById('timerDigits');
    arc.style.strokeDashoffset = offset;
    // colour states
    arc.classList.remove('warning','urgent');
    digits.classList.remove('warning','urgent');
    if (remaining <= 3) { arc.classList.add('urgent');  digits.classList.add('urgent'); }
    else if (remaining <= 6) { arc.classList.add('warning'); digits.classList.add('warning'); }
    digits.textContent = remaining;
  }

  function timerStart() {
    if (timerRunning) {
      // pause
      clearInterval(timerInterval);
      timerRunning = false;
      document.getElementById('timerStartBtn').textContent = 'Resume';
      return;
    }
    if (timerRemaining <= 0) return;
    timerRunning = true;
    document.getElementById('timerStartBtn').textContent = 'Pause';
    timerInterval = setInterval(() => {
      timerRemaining--;
      // pulse the digit
      const digits = document.getElementById('timerDigits');
      digits.classList.remove('pulse');
      void digits.offsetWidth;
      digits.classList.add('pulse');
      timerSetArc(timerRemaining);
      if (timerRemaining <= 0) {
        clearInterval(timerInterval);
        timerRunning = false;
        document.getElementById('timerStartBtn').textContent = 'Start';
        document.getElementById('timerStartBtn').disabled = true;
      }
    }, 1000);
  }

  function timerReset() {
    clearInterval(timerInterval);
    timerRunning = false;
    timerRemaining = TIMER_DURATION;
    timerSetArc(TIMER_DURATION);
    document.getElementById('timerStartBtn').textContent = 'Start';
    document.getElementById('timerStartBtn').disabled = false;
  }

  // Init arc
  timerSetArc(TIMER_DURATION);

  if ('serviceWorker' in navigator) window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js').catch(()=>{}));
</script>
<div class="version-mark">v3.02</div>
</body>
</html>
